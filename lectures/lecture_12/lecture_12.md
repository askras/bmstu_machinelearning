---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.16.4
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

<!-- #region editable=true jupyterlab-deck={"layer": "deck"} slideshow={"slide_type": "slide"} -->
# –õ–µ–∫—Ü–∏—è 12: –î–µ—Ä–µ–≤—å—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

–ú–ì–¢–£ –∏–º. –ù.–≠. –ë–∞—É–º–∞–Ω–∞

–ö—Ä–∞—Å–Ω–∏–∫–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á

https://github.com/askras/bmstu_machinelearning/

2024
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥

![](./img/credit_scoring_tree.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ò–≥—Ä–∞ –≤ –≥–æ–ª—å—Ñ

![](./img/golf_tree.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –î–µ—Ä–µ–≤–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π (–†–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ)

–†–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ ‚Äì —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º:
- –∫–∞–∂–¥–æ–π —É–∑–ª–æ–≤–æ–π –≤–µ—Ä—à–∏–Ω–µ $v$ –ø—Ä–∏–ø–∏—Å–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è (–ø—Ä–µ–¥–∏–∫–∞—Ç) $\beta(v): X \rightarrow \{0, 1\}$
- –∫–∞–∂–¥–æ–π –ª–∏—Å—Ç–æ–≤–æ–π –≤–µ—Ä—à–∏–Ω–µ $v$ –ø—Ä–∏–ø–∏—Å–∞–Ω –ø—Ä–æ–≥–Ω–æ–∑ $c_v \in Y$ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Äì –∫–ª–∞—Å—Å –∏–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞, –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ ‚Äì –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ñ–∞–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞

**–®–∞–≥ 1**: –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–∏ $X$ –Ω–∞ –¥–≤–µ
—á–∞—Å—Ç–∏: 
$$R_l(j ,t) = \{x | x_j > t\}$$
$$R_r(j ,t) = \{x | x_j \leqslant t\}$$
—Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ $Q(X, j, t)$ 

- –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–∏–µ $j$ –∏ $t$
- —Å–æ–∑–¥–∞–¥–∏–º –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞, –ø–æ—Å—Ç–∞–≤–∏–≤ –≤ –Ω–µ–≥–æ –ø—Ä–µ–¥–∏–∫–∞—Ç $[x_j > t]$.

**–®–∞–≥ 2**: –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ–¥–≤—ã–±–æ—Ä–æ–∫ $R_l$ –∏ $R_r$ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–º —à–∞–≥ 1. –ò —Ç.–¥.

–í –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å –ª–∏ —É—Å–ª–æ–≤–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∞.
–ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å, —Ç–æ –æ–±—ä—è–≤–ª—è–µ–º –≤–µ—Ä—à–∏–Ω—É –ª–∏—Å—Ç–æ–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –Ω–µ–≥–æ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∏–º–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

- –ö—Ä–∏—Ç–µ—Ä–∏–π –∫–∞—á–µ—Å—Ç–≤–∞ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

![](./img/example_tree_00.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ñ–∞–¥–Ω–æ –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–∏–π –ø—Ä–µ–¥–∏–∫–∞—Ç

![](./img/example_tree_01.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ñ–∞–¥–Ω–æ –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–∏–π –ø—Ä–µ–¥–∏–∫–∞—Ç

![](./img/example_tree_02.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ñ–∞–¥–Ω–æ –Ω–∞–π–¥–µ–º –Ω–∞–∏–ª—É—á—à–∏–π –ø—Ä–µ–¥–∏–∫–∞—Ç

![](./img/example_tree_03.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ù–∞—à–ª–∏ –ª—É—á—à–µ–µ –ø–µ—Ä–≤–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

![](./img/example_tree_04.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ù–∞—à–ª–∏ –ª—É—á—à–µ–µ –ø–µ—Ä–≤–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

![](./img/example_tree_05.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ù–∞—à–ª–∏ –ª—É—á—à–µ–µ –≤—Ç–æ—Ä–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

![](./img/example_tree_06.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ü–æ—Å—Ç—Ä–æ–∏–º –≤—Å–µ –¥–µ—Ä–µ–≤–æ

![](./img/example_tree_07.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∏–º–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

![](./img/example_tree_10.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ù–∞—à–ª–∏ –ø–µ—Ä–≤–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

![](./img/example_tree_11.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ù–∞—à–ª–∏ –≤—Ç–æ—Ä–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

![](./img/example_tree_12.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞

- –í–∏–¥ –ø—Ä–µ–¥–∏–∫–∞—Ç–æ–≤ –≤ –≤–µ—Ä—à–∏–Ω–∞—Ö
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞ $Q(X, j, t)$
- –ú–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∞
- –ú–µ—Ç–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã –¥–µ—Ä–µ–≤–∞
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ö—Ä–∏—Ç–µ—Ä–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏

- –ü—É—Å—Ç—å $ùëÖ$ ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–¥–∞—é—â–∏—Ö –≤ –≤–µ—Ä—à–∏–Ω—É –Ω–∞ –¥–∞–Ω–Ω–æ–º —à–∞–≥–µ, –∞ $R_l$ –∏ $R_r$ - –æ–±—ä–µ–∫—Ç—ã, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ –ª–µ–≤—É—é –∏ –ø—Ä–∞–≤—É—é –≤–µ—Ç–∫–∏ –ø–æ—Å–ª–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è.
- –¶–µ–ª—å: —á—Ç–æ–±—ã –ø–æ—Å–ª–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –æ–±—ä–µ–∫—Ç–æ–≤ –±—ã–ª–æ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.
![](./img/info_index.png)
- $H(R)$ - **–∫—Ä–∏—Ç–µ—Ä–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏** - –º–µ—Ä–∞ –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤—ã—Ö (—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ) –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã ùëÖ.
- –ß–µ–º –º–µ–Ω—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã, —Ç–µ–º –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ $H(R)$. –¢–æ –µ—Å—Ç—å –Ω–µ–æ–±–æ—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å $H(R):$
$$H(R_l) \rightarrow \min, \quad H(R_r) \rightarrow \min$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥–∏–∫–∞—Ç–∞

 –î–ª—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–µ–≥–æ –ø—Ä–µ–¥–∏–∫–∞—Ç–∞ –¥–ª—è —É–∑–ª–∞ –¥–µ—Ä–µ–≤–∞ –∑–∞–¥–∞–¥–∏–º –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞:
$$Q(R, j, t) = H(R) -
\left(
     \cfrac{|R_l|}{|R|} \cdot H(R_l)
    +
    \cfrac{|R_r|}{|R|} \cdot H(R_r)
\right) \rightarrow \max\limits_{j, t},
$$ –≥–¥–µ
- $R$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –≤–µ—Ä—à–∏–Ω—É, —Ä–∞–∑–±–∏–≤–∞–µ–º—É—é –Ω–∞ –¥–∞–Ω–Ω–æ–º —à–∞–≥–µ,
- $R_l$, $R_r$ - –æ–±—ä–µ–∫—Ç—ã, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ –ª–µ–≤–æ–µ –∏ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º –ø—Ä–µ–¥–∏–∫–∞—Ç–µ
- $|R|$, $|R_l|$, $|R_r|$ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—â–∏—Ö –º–Ω–æ–∂–µ—Å—Ç–≤–∞—Ö (–º–æ—â–Ω–æ—Å—Ç—å)
- $H(R)$ - –∫—Ä–∏—Ç–µ—Ä–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–µ—Ä—à–∏–Ω—ã (impurity criterion), –∫–æ—Ç–æ—Ä—ã–π –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤
- $Q(R_m, j, t)$ - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–∏–¥ –∫—Ä–∏—Ç–µ—Ä–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏

- –í –∫–∞–∂–¥–æ–º –ª–∏—Å—Ç–µ –¥–µ—Ä–µ–≤–æ –≤—ã–¥–∞–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É $c$:
  - –¥–ª—è –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ - –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ
  - –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –∫–ª–∞—Å—Å (–∏–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞)
- –ß–µ–º –ª—É—á—à–µ –æ–±—ä–µ–∫—Ç—ã –≤ –ª–∏—Å—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —ç—Ç–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π, —Ç–µ–º –º–µ–Ω—å—à–µ —Å—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç–∞—Ö:
$$H(R) = \min\limits_{c \in \mathbb{R}} \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R} L(y_i, c),$$
–≥–¥–µ
–≥–¥–µ $ L(y_i, c)$ ‚Äì –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –í–∏–¥ –∫—Ä–∏—Ç–µ—Ä–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –∑–∞–¥–∞—á–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

–ï—Å–ª–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –º—ã –±–µ—Ä—ë–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—É—é –æ—à–∏–±–∫—É, —Ç–æ

$$H(R) = \min\limits_{c \in \mathbb{R}}  \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R} (y_i - c)^2$$

–ï—ë –º–∏–Ω–∏–º—É–º –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏
$$c = \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R} y_i$$
—Ç–æ –µ—Å—Ç—å –≤ –ª–∏—Å—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ –æ–±—ä–µ–∫—Ç–∞—Ö, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –ª–∏—Å—Ç.

–ó–Ω–∞—á–∏—Ç, **–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å $H(R)$ –≤ –ª–∏—Å—Ç–µ ‚Äì —ç—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏—è** —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ —ç—Ç–æ—Ç –ª–∏—Å—Ç).
–ß–µ–º –º–µ–Ω—å—à–µ –¥–∏—Å–ø–µ—Ä—Å–∏—è, —Ç–µ–º –º–µ–Ω—å—à–µ —Ä–∞–∑–±—Ä–æ—Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –ª–∏—Å—Ç.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∏–º–µ—Ä: —Ä–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ –≤ –∑–∞–¥–∞—á–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –≤ –ª–∏—Å—Ç –¥–µ—Ä–µ–≤–∞ –ø–æ–ø–∞–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤. –í –∫–∞–∂–¥–æ–º –ª–∏—Å—Ç–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É.

–ö–∞–∫—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –≤—ã–≥–æ–¥–Ω–µ–µ –≤—Å–µ–≥–æ –≤—ã–¥–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞?

![](./img/example_regtree_01.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∏–º–µ—Ä: —Ä–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ –≤ –∑–∞–¥–∞—á–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

–ï—Å–ª–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –æ—à–∏–±–∫–∏ –≤ –ª–∏—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—É—é –æ—à–∏–±–∫—É, —Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞–¥–æ –≤—ã–¥–∞–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –ª–∏—Å—Ç.

![](./img/example_regtree_02.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –í–∏–¥ –∫—Ä–∏—Ç–µ—Ä–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—É—Å—Ç—å —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å $K$ –∫–ª–∞—Å—Å–∞–º–∏: $1, 2, \ldots, K$.

- $p_k$ –¥–æ–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ $k$, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –≤–µ—Ä—à–∏–Ω—É:
$$p_k = \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R} [y_i = k]$$

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –û—à–∏–±–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Missclassification errror)

–ü—É—Å—Ç—å $c$ - —Å–∞–º—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –≤ –¥–∞–Ω–Ω–æ–π –≤–µ—Ä—à–∏–Ω–µ:
$$c = \arg\max\limits_k p_k$$

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—à–∏–±–∫–∏ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å

$$H(R) = \min\limits_{c \in Y} \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R}[y_i \ne c] $$

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –±—É–¥–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∫–ª–∞—Å—Å $k_*$ ‚Äî –∑–Ω–∞—á–∏—Ç, –∫—Ä–∏—Ç–µ—Ä–∏–π –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Å–ª–µ–¥—É—é—â–µ–π –¥–æ–ª–µ –æ—à–∏–±–æ–∫:

$$H(R) = \cfrac{1}{|R|} \sum\limits_{(x_i, y_i) \in R}[y_i \ne k_*] = 1 - p_{k_*}$$

–î–∞–Ω–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥—Ä—É–±—ã–º, –ø–æ—Å–∫–æ–ª—å–∫—É —É—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É $p_{k_*}$ –ª–∏—à—å –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ö—Ä–∏—Ç–µ—Ä–∏–π –î–∂–∏–Ω–∏ (Gini Index)

–ë—É–¥–µ–º –≤ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –≤—ã–¥–∞–≤–∞—Ç—å –Ω–µ –∫–ª–∞—Å—Å, –∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤: $$c = (c_1, c_2, \ldots, K), \qquad \sum\limits_{k=1}^K c_k= 1$$

–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ—Ä–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –∫—Ä–∏—Ç–µ—Ä–∏—è –ë—Ä–∏–µ—Ä–∞:

$$
  H(R) = 
  \min\limits_c 
  \cfrac{1}{|R|} 
  \sum\limits_{(x_i, y_i) \in R}
  \sum\limits_{k=1}^K 
  (c_k - [y_i = k])^2
$$

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ $H(R)$ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –Ω–∞ –≤–µ–∫—Ç–æ—Ä–µ, —Å–æ—Å—Ç–æ—è—â–µ–º –∏–∑ –¥–æ–ª–µ–π –∫–ª–∞—Å—Å–æ–≤: $c_* = (p_1, p_2, \ldots, p_k)$.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∫—Ä–∏—Ç–µ—Ä–∏–π –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω
$$H(R) = \sum\limits_{k=1}^K p_k(1-p_k)$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏—è –î–∂–∏–Ω–∏

![](./img/gini.png)
- –î–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R) = 
    \color{blue}
    p_1(1-p_1)
    \color{black} + 
    \color{red}
    p_2(1-p_2)
    \color{black} = 
    \color{blue}
    \cfrac{4}{8} \left(1- \cfrac{4}{8}\right) 
    \color{black} + 
    \color{red}
    \cfrac{4}{8} \left(1- \cfrac{4}{8}\right)
    \color{black}
  = \cfrac{1}{2}
$$
- –ü–µ—Ä–≤–∞—è (–Ω–µ—É–¥–∞—á–Ω–∞—è) –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R_l) = 
    \color{blue}
    p_1(1-p_1)
    \color{black} + 
    \color{red}
    p_2(1-p_2)
    \color{black} = 
    \color{blue}
    \cfrac{2}{2} \left(1- \cfrac{2}{2}\right) 
    \color{black} + 
    \color{red}
    \cfrac{0}{2} \left(1- \cfrac{0}{2}\right)
    \color{black}
  = 0
$$
$$
  H(R_r) = 
    \color{blue}
    p_1(1-p_1)
    \color{black} + 
    \color{red}
    p_2(1-p_2)
    \color{black} = 
    \color{blue}
    \cfrac{2}{6} \left(1- \cfrac{2}{6}\right) 
    \color{black} + 
    \color{red}
    \cfrac{4}{6} \left(1- \cfrac{4}{6}\right)
    \color{black}
  = \cfrac{4}{9}
$$
$$Q(R,j,t) = H(R) - \cfrac{|R_l|}{|R|} H(R_l) - \cfrac{|R_r|}{|R|} H(R_r) =$$
$$= \cfrac{1}{2} - \cfrac{2}{8} \cdot 0 - \cfrac{6}{8} \cdot \cfrac{4}{9} = \cfrac{1}{6} $$
- –í—Ç–æ—Ä–∞—è (—É–¥–∞—á–Ω–∞—è) –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R_l) = 
    \color{blue}
    p_1(1-p_1)
    \color{black} + 
    \color{red}
    p_2(1-p_2)
    \color{black} = 
    \color{blue}
    \cfrac{4}{4} \left(1- \cfrac{4}{4}\right) 
    \color{black} + 
    \color{red}
    \cfrac{0}{4} \left(1- \cfrac{0}{4}\right)
    \color{black}
  = 0
$$
$$
  H(R_r) = 
    \color{blue}
    p_1(1-p_1)
    \color{black} + 
    \color{red}
    p_2(1-p_2)
    \color{black} = 
    \color{blue}
    \cfrac{0}{4} \left(1- \cfrac{0}{4}\right) 
    \color{black} + 
    \color{red}
    \cfrac{4}{4} \left(1- \cfrac{4}{4}\right)
    \color{black}
  = 0
$$
$$Q(R,j,t) = H(R) - \cfrac{|R_l|}{|R|} H(R_l) - \cfrac{|R_r|}{|R|} H(R_r) =$$
$$= \cfrac{1}{2} - \cfrac{4}{8} \cdot 0 - \cfrac{4}{8} \cdot 0 = \cfrac{1}{2} $$

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π (Entropy)

–ó–∞–ø–∏—à–µ–º –ª–æ–≥–∞—Ä–∏—Ñ–º –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è:

$$H(R) = - \min\limits_c 
\left(
  \cfrac{1}{|R|}
  \sum\limits_{(x_i, y_i) \in R}
  \sum\limits_{k=1}^K 
  [y_i = k] \log c_k
\right)
$$

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ $H(R)$ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –Ω–∞ –≤–µ–∫—Ç–æ—Ä–µ, —Å–æ—Å—Ç–æ—è—â–µ–º –∏–∑ –¥–æ–ª–µ–π –∫–ª–∞—Å—Å–æ–≤: $c_* = (p_1, p_2, \ldots, p_k)$.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∫—Ä–∏—Ç–µ—Ä–∏–π –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω

$$H(R) = - \sum\limits_{k=1}^K p_k \log p_k$$

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
- –≠–Ω—Ç—Ä–æ–ø–∏—è $H(R) \geqslant 0$ (–º–∏–Ω–∏–º—É–º –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ $p_i=1$, $p_j = 0$, $i\ne j$)
- $\max H(R)$ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ $p_1 = p_2 = \cdots = p_K = \cfrac{1}{K}$

![](./img/entropy.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–π–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è

![](./img/gini.png)
- –î–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R) = 
    \color{blue}
    -p_1 \log p_1
    \color{red}
    -p_2 \log p_2
    \color{black} = 
    \color{blue}
    -\cfrac{4}{8} \log \left(\cfrac{4}{8}\right) 
    \color{red}
    -\cfrac{4}{8} \log \left(\cfrac{4}{8}\right)
    \color{black}
  = 1
$$
- –ü–µ—Ä–≤–∞—è (–Ω–µ—É–¥–∞—á–Ω–∞—è) –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R_l) = 
    \color{blue}
    -p_1 \log p_1
    \color{red}
    -p_2 \log p_2
    \color{black} = 
    \color{blue}
    -\cfrac{2}{2} \log \left(\cfrac{2}{2}\right) 
    \color{red}
    -\cfrac{0}{2} \log \left(\cfrac{0}{2}\right) 
    \color{black}
  \rightarrow 0
$$
$$
  H(R_r) = 
    \color{blue}
    -p_1 \log p_1
    \color{red}
    -p_2 \log p_2
    \color{black} = 
    \color{blue}
    -\cfrac{2}{6} \log \left(\cfrac{2}{6}\right) 
    \color{red}
    -\cfrac{4}{6} \log \left(\cfrac{4}{6}\right) 
    \color{black}
  \approx 0.92
$$
$$Q(R,j,t) = H(R) - \cfrac{|R_l|}{|R|} H(R_l) - \cfrac{|R_r|}{|R|} H(R_r) =$$
$$= 1 - \cfrac{2}{8} \cdot 0 - \cfrac{6}{8} \cdot 0.92 \approx 0.32 $$
- –í—Ç–æ—Ä–∞—è (—É–¥–∞—á–Ω–∞—è) –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è
$$
  H(R_l) = 
    \color{blue}
    -p_1 \log p_1
    \color{red}
    -p_2 \log p_2
    \color{black} = 
    \color{blue}
    -\cfrac{4}{4} \log \left(\cfrac{4}{4}\right) 
    \color{red}
    -\cfrac{0}{4} \log \left(\cfrac{0}{4}\right) 
    \color{black}
  \rightarrow 0
$$
$$
  H(R_r) = 
    \color{blue}
    -p_1 \log p_1
    \color{red}
    -p_2 \log p_2
    \color{black} = 
    \color{blue}
    -\cfrac{0}{4} \log \left(\cfrac{0}{4}\right) 
    \color{red}
    -\cfrac{4}{4} \log \left(\cfrac{4}{4}\right) 
    \color{black}
  \rightarrow 0
$$
$$Q(R,j,t) = H(R) - \cfrac{|R_l|}{|R|} H(R_l) - \cfrac{|R_r|}{|R|} H(R_r) =$$
$$= 1 - \cfrac{4}{8} \cdot 0 - \cfrac{4}{8} \cdot 0 = 1 $$




<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏

![](./img/missclassification_error.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞

- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω—ã –¥–µ—Ä–µ–≤–∞ (max_depth)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ª–∏—Å—Ç—å—è—Ö (min_samples_leaf)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –ª–∏—Å—Ç—å–µ–≤ –≤ –¥–µ—Ä–µ–≤–µ
- –û—Å—Ç–∞–Ω–æ–≤ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –≤ –ª–∏—Å—Ç–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É –∫–ª–∞—Å—Å—É
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ –¥—Ä–æ–±–ª–µ–Ω–∏–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–ª—Å—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º –Ω–∞ $s\%$
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ—Å—Ç–∏–≥ —Ü–µ–ª–µ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è $Q(R_m, j, t) > h$ 

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–∞–∂–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∞

- –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–µ—Ä–µ–≤–∞
- –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –≥–ª—É–±–∏–Ω—É —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞
- –û—á–µ–Ω—å –≥–ª—É–±–æ–∫–∏–µ –¥–µ—Ä–µ–≤—å—è –ø–µ—Ä–µ–æ–±—É—á–∞—é—Ç—Å—è
- –ù–µ–≥–ª—É–±–æ–∫–∏–µ –¥–µ—Ä–µ–≤—å—è –Ω–µ–¥–æ–æ–±—É—á–∞—é—Ç—Å—è

![](./img/stoping.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –°—Ç—Ä–∏–∂–∫–∞ (pruning) –¥–µ—Ä–µ–≤—å–µ–≤

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –¥–µ—Ä–µ–≤–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –µ–≥–æ –≤–µ—Ä—à–∏–Ω, —á—Ç–æ–±—ã –ø–æ–Ω–∏–∑–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ —Å–Ω–∏–∑–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Å—Ç—Ä–∏–∂–∫–∞ –¥–µ—Ä–µ–≤–∞ –∏–ª–∏ pruning).

- –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ —Å—Ç—Ä–∏–∂–∫–∏ –¥–µ—Ä–µ–≤—å–µ–≤
- –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ

![](./img/pruning.png)
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ü—Ä–∏–º–µ—Ä

![](./img/example_tree_08.png)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏ –≤ –≤–µ—Ä—à–∏–Ω–µ –¥–µ—Ä–µ–≤–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–û–±—É—á–µ–Ω–∏–µ** —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞:
- –ü—É—Å—Ç—å –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ $j$ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω—ã
- –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ª—É—á—à–µ–≥–æ –ø—Ä–µ–¥–∏–∫–∞—Ç–∞ $\{x_j > t\}$ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–æ–ø—É—Å–∫–∏ $x_j$.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞:
- –ï—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ $x_j$ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞, —Ç–æ –∏–¥–µ–º –∏ –≤–ª–µ–≤–æ, –∏ –≤–ø—Ä–∞–≤–æ.
- –î–µ–ª–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –≤ –æ–±–æ–∏—Ö –ø–æ–¥–¥–µ—Ä–µ–≤—å—è—Ö
- –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ $\hat{y}$ - –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ä–µ–¥–Ω—è–µ–º:
$$\hat{y} = \cfrac{|R_l|}{|R|}\cdot \hat{y}_l + \cfrac{|R_r|}{|R|}\cdot \hat{y}_r$$
<!-- #endregion -->
<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–†–µ—à–∞—é—â–µ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –ø—Ä–æ–≥–Ω–æ–∑

–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∞ $j$ (feature importance):
$$FIM_j = \sum\limits_{node \in T(j)} |R_m| Q(R_m, j, t)$$
–≥–¥–µ
$T(j)$ - –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã –¥–µ—Ä–µ–≤–∞, –≥–¥–µ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫ $j: \{x_j > t\}$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ú–µ—Ç–æ–¥—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤—å–µ–≤
- ID3
  - –≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π
  - –¢–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- C4.5
  - –ö—Ä–∏—Ç–µ—Ä–∏–π Gain Ratio
  - Error-Based Prunning
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∫–∞–∫ –æ–ø–∏—Å–∞–ª–∏ –≤—ã—à–µ
- CART (sklearn)
  - –ö—Ä–∏—Ç–µ—Ä–∏–π –î–∂–∏–Ω–∏
  - Cost-Complexity Pruning
  - –ú–µ—Ç–æ–¥ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –ø—Ä–µ–¥–∏–∫–∞—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ü–ª—é—Å—ã —Ä–µ—à–∞—é—â–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤
- –ß–µ—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, &laquo;–≤–æ–∑—Ä–∞—Å—Ç > 25&raquo;)
- –î–µ—Ä–µ–≤—å—è —Ä–µ—à–µ–Ω–∏–π –ª–µ–≥–∫–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è, —Ç–æ –µ—Å—Ç—å —Ö–æ—Ä–æ—à–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—é—Ç—Å—è
- –ë—ã—Å—Ç—Ä–æ –æ–±—É—á–∞—é—Ç—Å—è –∏ –≤—ã–¥–∞—é—Ç –ø—Ä–æ–≥–Ω–æ–∑
- –ú–∞–ª–æ–µ —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ú–∏–Ω—É—Å—ã —Ä–µ—à–∞—é—â–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤

- –û—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ —à—É–º–∞–º –≤ –¥–∞–Ω–Ω—ã—Ö, –º–æ–¥–µ–ª—å —Å–∏–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
- –†–∞–∑–¥–µ–ª—è—é—â–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –∏–º–µ–µ—Ç —Å–≤–æ–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–µ–π)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –±–æ—Ä—å–±—ã —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º (—Å—Ç—Ä–∏–∂–∫–∞ –∏–ª–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ –∏–∑ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Å—Ç–∞–Ω–æ–≤–∞)
- –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ (NP-–ø–æ–ª–Ω–∞—è –∑–∞–¥–∞—á–∞, –ø–æ—ç—Ç–æ–º—É –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∂–∞–¥–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
import matplotlib.pyplot as plt
%matplotlib inline

from mlxtend.plotting import plot_decision_regions
import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, mean_squared_error
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor, plot_tree
import pandas as pd

plt.rcParams["figure.figsize"] = (11, 6.5)
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π

–î–∞–≤–∞–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä –ª–∏–Ω–µ–π–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–º–æ–π –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
n = 400
np.random.seed(1)
X = np.zeros((n, 2))
X[:, 0] = np.linspace(-5, 5, n)
X[:, 1] = X[:, 0] + 0.5 * np.random.normal(size=n)
y = (X[:, 1] > X[:, 0]).astype(int)

plt.scatter(X[:, 0], X[:, 1], s=100, c=y, cmap='bwr')
plt.show()
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å —Ä–∞–∑–¥–µ–ª—è—é—â–µ–π –ø—Ä—è–º–æ–π.
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
def train_model(model=LogisticRegression()):
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=13)
    model.fit(X_train, y_train)
    y_pred = model.predict(X_test)
    plot_decision_regions(X_test, y_test, model)
    plt.show()

    print(f"Accuracy: {accuracy_score(y_pred, y_test):.2f}")

train_model(LogisticRegression())
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
–°—Ä–∞–≤–Ω–∏–º –∫–∞—á–µ—Å—Ç–≤–æ, —Ç–∞–∫ –ª–∏ —Ö–æ—Ä–æ—à–æ –ø–æ–ª—É—á–∏—Ç—Å—è —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –Ω–µ –ª–æ–≥–∏—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π, –∞ –¥–µ—Ä–µ–≤–æ–º —Ä–µ—à–µ–Ω–∏–π –Ω–∞ –ª–∏–Ω–µ–π–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–º–æ–π –≤—ã–±–æ—Ä–∫–µ?
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
train_model(DecisionTreeClassifier(random_state=13))
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
–î–∞–≤–∞–π—Ç–µ –≤—Å–ø–æ–º–Ω–∏–º, —á—Ç–æ —Ç–∞–∫–æ–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–∞—é—â–µ–µ –ò–õ–ò, –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏. 
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
X = np.random.randn(n, 2)
y = np.logical_xor(X[:, 0] > 0, X[:, 1] > 0).astype(int)
plt.scatter(X[:, 0], X[:, 1], s=100, c=y, cmap="bwr")
plt.show()
```

```python editable=true slideshow={"slide_type": "subslide"}
train_model(LogisticRegression())
```

```python editable=true slideshow={"slide_type": "fragment"}
train_model(DecisionTreeClassifier())
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ <a name="overfitting"></a>


–†–µ—à–∞—é—â–∏–µ –¥–µ—Ä–µ–≤—å—è –º–æ–≥—É—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –ø–æ–¥ –ª—é–±—É—é –≤—ã–±–æ—Ä–∫—É, –µ—Å–ª–∏ –∏—Ö –Ω–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–æ–≤–∞—Ç—å: –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ª–∏—Å—Ç—å–µ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–∂–µ—Ç –≤—ã–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ—è –æ–±–ª–∞—Å—Ç—å –≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Å—Ç–æ –≤—ã—É—á–∏–≤–∞–µ—Ç –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É, –Ω–æ –Ω–µ –≤—ã–¥–µ–ª—è–µ—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –î–∞–≤–∞–π—Ç–µ —É–±–µ–¥–∏–º—Å—è –≤ —ç—Ç–æ–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
np.random.seed(13)
n = 100
X = np.random.normal(size=(n, 2))
X[:50, :] += 0.25
X[50:, :] -= 0.25
y = np.array([1] * 50 + [0] * 50)
plt.scatter(X[:, 0], X[:, 1], s=100, c=y, cmap="bwr")
plt.show()
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
–ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ—à–∞—é—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

- `max_depth`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞
- `min_samples_leaf`: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–µ—Ä—à–∏–Ω–µ –¥–µ—Ä–µ–≤–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–Ω–∞ —Å—Ç–∞–ª–∞ –ª–∏—Å—Ç–æ–º
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
fig, ax = plt.subplots(nrows=3, ncols=3, figsize=(15, 12))

for i, max_depth in enumerate([3, 5, None]):
    for j, min_samples_leaf in enumerate([1, 5, 15]):
        dt = DecisionTreeClassifier(max_depth=max_depth, min_samples_leaf=min_samples_leaf, random_state=13)
        dt.fit(X, y)
        ax[i][j].set_title("max_depth = {} | min_samples_leaf = {}".format(max_depth, min_samples_leaf))
        ax[i][j].axis("off")
        plot_decision_regions(X, y, dt, ax=ax[i][j])
        
plt.show()
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
–ù–∞ –ª—é–±–æ–π –≤—ã–±–æ—Ä–∫–µ (–∏—Å–∫–ª—é—á–∞—è —Ç–µ, –≥–¥–µ –µ—Å—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏) –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω—É–ª–µ–≤—É—é –æ—à–∏–±–∫—É - —Å –ø–æ–º–æ—â—å—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞:
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
model = DecisionTreeClassifier(max_depth=None, min_samples_leaf=1, random_state=13)
model.fit(X, y)

print(f"Accuracy: {accuracy_score(y, dt.predict(X)):.2f}")

plot_decision_regions(X, y, model)
plt.show()
```

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ù–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–ö–∞–∫ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞, –µ—Å–ª–∏ –±—Ä–∞—Ç—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ä–∞–∑–Ω—ã–µ 90%-—ã–µ –ø–æ–¥–≤—ã–±–æ—Ä–∫–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π?
<!-- #endregion -->

```python editable=true slideshow={"slide_type": "fragment"}
fig, ax = plt.subplots(nrows=3, ncols=3, figsize=(15, 12))

for i in range(3):
    for j in range(3):
        seed_idx = 3 * i + j
        np.random.seed(seed_idx)
        dt = DecisionTreeClassifier(random_state=13)
        idx_part = np.random.choice(len(X), replace=False, size=int(0.9 * len(X)))
        X_part, y_part = X[idx_part, :], y[idx_part]
        dt.fit(X_part, y_part)
        ax[i][j].set_title("sample #{}".format(seed_idx))
        ax[i][j].axis("off")
        plot_decision_regions(X_part, y_part, dt, ax=ax[i][j])
        
plt.show()
```
