---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.16.4
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

<!-- #region executionInfo={"elapsed": 4, "status": "ok", "timestamp": 1702453591048, "user": {"displayName": "Sergey Korpachev", "userId": "09181340988160569540"}, "user_tz": -180} id="Ksn9azeZa-Zr" editable=true slideshow={"slide_type": "slide"} -->
# –õ–µ–∫—Ü–∏—è 16: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

–ú–ì–¢–£ –∏–º. –ù.–≠. –ë–∞—É–º–∞–Ω–∞

–ö—Ä–∞—Å–Ω–∏–∫–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á

https://github.com/askras/bmstu_machinelearning/

2024
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
–° —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–∂–Ω–æ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Ç–∞–º, –≥–¥–µ –µ—Å—Ç—å –±–æ–ª—å—à–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–µ –¥–ª—è —Å–µ–±—è —Ç–æ–≤–∞—Ä—ã. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç–æ–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—ä–µ–∫—Ç—ã, —Ç–µ–º —Å–∞–º—ã–º —ç–∫–æ–Ω–æ–º—è –µ–≥–æ –≤—Ä–µ–º—è.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "subslide"} -->
### –ö–∞–∫–æ–π —Ñ–∏–ª—å–º —Å–º–æ—Ç—Ä–µ—Ç—å?

![](./img/rec_film.png)
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ö–∞–∫—É—é –º—É–∑—ã–∫—É —Å–ª—É—à–∞—Ç—å?

![](./img/rec_mus.png)
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ò –¥–∞–∂–µ –Ω–∞ –∫–∞–∫—É—é –ª–µ–∫—Ü–∏—é –∏–¥—Ç–∏? :)
![](./img/rec_lec.png)
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ó–∞ –Ω–∞—Å —É–∂–µ –≤—Å–µ —Ä–µ—à–∏–ª–∏

- –ö–∞–∫—É—é –º—É–∑—ã–∫—É —Å–ª—É—à–∞—Ç—å?
- –ö–∞–∫–æ–π —Ñ–∏–ª—å–º —Å–º–æ—Ç—Ä–µ—Ç—å?
- –ö–∞–∫—É—é –∫–Ω–∏–≥—É —á–∏—Ç–∞—Ç—å?
- –ö–∞–∫—É—é –µ–¥—É –µ—Å—Ç—å?
- –ö–∞–∫—É—é –æ–¥–µ–∂–¥—É –Ω–∞–¥–µ—Ç—å?
- –í –∫–∞–∫—É—é –∏–≥—Ä—É –∏–≥—Ä–∞—Ç—å?
- –ù–∞ –∫–∞–∫—É—é –ª–µ–∫—Ü–∏—é –∏–¥—Ç–∏? 

![](./img/rec_food.png)
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –ü–æ–∏—Å–∫ vs —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –í –∑–∞–¥–∞—á–µ –ø–æ–∏—Å–∫–∞ –µ—Å—Ç—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í –∑–∞–¥–∞—á–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ—Ç, –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ –Ω–∞–¥–µ–∂–¥–∞ –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –µ–≥–æ —Å–∫—Ä—ã—Ç—ã–µ –∂–µ–ª–∞–Ω–∏—è.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á–∏

- –ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** $U$ (Users)–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ **–æ–±—ä–µ–∫—Ç–æ–≤** $I$ (Items). 
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u \in U$ –µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ $i \in I$, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª –∏ –∫–æ—Ç–æ—Ä—ã–º –ø–æ—Å—Ç–∞–≤–∏–ª **–æ—Ü–µ–Ω–∫–∏** (—Ä–µ–π—Ç–∏–Ω–≥–∏) $R_u=(r_{ui})_{i\in I_u}$.
- **–†–µ–π—Ç–∏–Ω–≥** (–∏–ª–∏ **—Ñ–∏–¥–±–µ–∫–æ–º**) ‚Äì —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–±—ä–µ–∫—Ç–æ–º; –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –µ–≥–æ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∫–æ—Ç–æ—Ä—É—é –≤—ã–±—Ä–∞–ª–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **–∑–∞–¥–∞—á—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º** –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u \in U$ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ $r_{ui}$ –¥–ª—è $i\in I /\ I_{u}$ –∏ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º $\hat{r}_{ui}$.

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –Ω–∞–¥–æ –Ω–∞—É—á–∏—Ç—å—Å—è —Å—Ä–µ–¥–∏ –Ω–µ–ø–æ–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–∏ –±—ã –µ–≥–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–¥–±–µ–∫–∞

- –î–ª—è —Ç–æ–≤–∞—Ä–∞ ‚Äì —Ñ–∞–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É;
- –î–ª—è –º—É–∑—ã–∫–∏ ‚Äì –¥–æ—Å–ª—É—à–∞–ª–∏ –ª–∏ —Ç—Ä–µ–∫ –¥–æ –∫–æ–Ω—Ü–∞;
- –î–ª—è —Å—Ç–∞—Ç—å–∏ ‚Äì –ª–∞–π–∫/–¥–∏–∑–ª–∞–π–∫;
- –î–ª—è –≤–∏–¥–µ–æ ‚Äì –≤—Ä–µ–º—è –µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ —Ñ–∞–∫—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É.

–§–∏–¥–±–µ–∫ —Ä–∞–∑–¥–µ–ª—è—é—Ç –Ω–∞ –¥–≤–∞ —Ç–∏–ø–∞ ‚Äì **explicit** –∏ **implicit**
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### Explicit (—è–≤–Ω—ã–π —Ñ–∏–¥–±–µ–∫)

Explicit, –∏–ª–∏ —è–≤–Ω—ã–π —Ñ–∏–¥–±–µ–∫ ‚Äì —ç—Ç–æ —Ç–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ –∫–æ—Ç–æ—Ä—ã–º —Ç–æ—á–Ω–æ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ª–∏ –µ–º—É –æ–±—ä–µ–∫—Ç. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ü–µ–Ω–∫–∞, –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è, —Ñ–∏–ª—å–º—É, –ª–∞–π–∫/–¥–∏–∑–ª–∞–π–∫ –∫ –≤–∏–¥–µ–æ –∏–ª–∏ —Ä–µ—Ü–µ–Ω–∑–∏—è –Ω–∞ –∫—É–ø–ª–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä. –¢–∞–∫–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞ –æ—á–µ–Ω—å –º–∞–ª–æ, –Ω–æ –æ–Ω –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ç–æ–≤–∞—Ä—É.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### Implicit (–Ω–µ—è–≤–Ω—ã–π —Ñ–∏–¥–±–µ–∫)
Implicit, –∏–ª–∏ –Ω–µ—è–≤–Ω—ã–π —Ñ–∏–¥–±–µ–∫ ‚Äì —ç—Ç–æ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ. 
–û–±—ã—á–Ω–æ —Ç–∞–∫–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –≤ —Ä–∞–∑—ã –±–æ–ª—å—à–µ, —á–µ–º —è–≤–Ω–æ–≥–æ, –æ–¥–Ω–∞–∫–æ –æ–Ω –±–æ–ª–µ–µ —à—É–º–Ω—ã–π, –∏ –Ω–µ —Å—Ç–æ–∏—Ç –¥–æ–≤–µ—Ä—è—Ç—å –µ–º—É —Ç–∞–∫ –∂–µ, –∫–∞–∫ —è–≤–Ω–æ–º—É. 

–§–∞–∫—Ç —Ç–æ–≥–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å–º–æ—Ç—Ä–µ–ª –≤–∏–¥–µ–æ –¥–æ –∫–æ–Ω—Ü–∞, –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –ª–∏ –æ–Ω–æ –µ–º—É, –æ–¥–Ω–∞–∫–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –¥–æ—Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö –≤–∏–¥–µ–æ –¥–æ –∫–æ–Ω—Ü–∞ –æ–Ω–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å. 

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ —Å—Ç–∞—Ç—å—é –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å—Å—è —Ç–∞–∫, —á—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—É—á–∏—Ç—Å—è –Ω–∞—Ö–æ–¥–∏—Ç—å –∫–ª–∏–∫–±–µ–π—Ç, –∞ –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Ç–∞—Ç—å–∏ ‚Äì —ç—Ç–æ –º–æ–∂–µ—Ç –ø–ª–æ—Ö–æ –æ—Ç—Ä–∞–∑–∏—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–∏—Å–µ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ.

–ü—Ä–∏–º–µ—Ä—ã –Ω–µ—è–≤–Ω–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞: 
- –∫–ª–∏–∫ –Ω–∞ —Å—Ç–∞—Ç—å—é
- –≤—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ
- –ø–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞.


<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –†–∞–Ω–∂–∏—Ä—É—é—â–∞—è –º–æ–¥–µ–ª—å

–ó–∞–¥–∞—á—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–Ω–æ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–ª–∏–∫/–Ω–µ –∫–ª–∏–∫) –∏–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—é (—Å–∫–æ–ª—å–∫–æ –∑–≤—ë–∑–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Å—Ç–∞–≤–∏—Ç –æ–±—ä–µ–∫—Ç—É), –Ω–æ —ç—Ç–æ –Ω–µ —Å–∞–º—ã–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

–û–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞–º –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–º–µ—Ç—å —Ç–æ—á–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–∏ $r_{ui}$. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–µ—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —ç—Ç–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –ó–∞–¥–∞—á–∞ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

<img src="./img/user_item_matrix.png" style="width:90%">

- $U$ ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Users)
- $I$ ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ (Items)
- $u$, $v$ ‚Äì –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- $i$, $j$ ‚Äì –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–≤–∞—Ä—ã
- $U_i$ ‚Äì –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ü–µ–Ω–∏–ª–∏ —Ç–æ–≤–∞—Ä $i$
- $I_u$ ‚Äì –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ü–µ–Ω–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å $u$
- $R_{ui}$ ‚Äì –∏—Å—Ç–∏–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ (Rating) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ $i$
- $\hat{R}_{ui}$ ‚Äì –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ùíñ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ $i$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –í–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
<img src="./img/col_filtr.png" style="width:90%">

- User-based
  - –û–ø—Ä–µ–¥–µ–ª—è–µ–º ¬´–ø–æ—Ö–æ–∂–µ—Å—Ç—å¬ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∏—Ö –æ—Ü–µ–Ω–∫–∞–º
- Item-based
  - –û–ø—Ä–µ–¥–µ–ª—è–µ–º ¬´–ø–æ—Ö–æ–∂–µ—Å—Ç—å¬ª —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∏—Ö –æ—Ü–µ–Ω–∫–∞–º
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### User-based filtering
–°—Ö–æ–¥—Å—Ç–≤–æ –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π $u$, $v$ –≤—ã—á–∏—Å–ª—è–µ–º —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ü–∏—Ä—Å–æ–Ω–∞:

$$w_{u v}=\frac{\sum_{i\in I_{u v}}(R_{u i}-\bar{R}_{u})(R_{v i}-\bar{R}_{v})}{\sqrt{\sum_{i\in I_{u v}}(R_{u i}-\bar{R}_{u})^{2}}\sqrt{\sum_{i\in I_{u v}}(R_{v i}-\bar{R}_{v})^{2}}}$$

- $I_{uv}$ -  –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ü–µ–Ω–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ $u$, $v$;
- $ \overline{R}_u$ -  —Å—Ä–µ–¥–Ω–µ–µ –æ—Ü–µ–Ω–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $u$.

<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –®–∞–≥–∏ User-based filtering

- –ù–∞—Ö–æ–¥–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π $U(u)$, –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –¥–∞–Ω–Ω–æ–≥–æ:
$$U(u)=\{v\in U|w_{u v}>\alpha\}$$

- –°—á–∏—Ç–∞–µ–º –∫–∞–∫ —á–∞—Å—Ç–æ —Ç–æ–≤–∞—Ä –ø–æ–∫—É–ø–∞–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ $U(u)$ :
$$p_{i}=\frac{|\{u{\in}U(u)|\exists R_{u i}\}|}{|U(u)|}$$

- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –æ—Ü–µ–Ω–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è :
$$\hat{R}_{u i}=\bar{R}_{u}+\frac{\sum_{v\in U(u)}w_{u v}(R_{v i}-\bar{R}_{v})}{\sum_{v\in U(u)}|w_{u v}|}$$

- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é $k$ —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º–∏ $p_i$, –ª–∏–±–æ $\hat{R}_{u i}$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
<img src="./img/user_based_filtering.png" style="width:90%">
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ User-Based filtering
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
  - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–µ–ø–ª–æ—Ö–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —è–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫.
- –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
  - –£ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ –æ—Ü–µ–Ω–æ–∫, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–µ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
  - –û—Ü–µ–Ω–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–µ–Ω—è—é—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –Ω–æ–≤–æ–π –æ—Ü–µ–Ω–∫–∏ –µ–≥–æ –ø–æ—Ö–æ–∂–µ—Å—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## Item-based filtering

–°—Ö–æ–¥—Å—Ç–≤–æ –¥–≤—É—Ö —Ç–æ–≤–∞—Ä–æ–≤ , –≤—ã—á–∏—Å–ª—è–µ–º —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ü–∏—Ä—Å–æ–Ω–∞:

$$w_{i j}=
\frac{\sum_{u\in U_{i j}}(R_{u i}-\bar{R}_{i})(R_{u j}-\bar{R}_{j})}
{
\sqrt{\sum_{u\in U_{i j}}\left(R_{u i}-\bar{R}_{i}\right)^{2}}
\,
\sqrt{\sum_{u\in U_{i j}}\left(R_{u j}-\bar{R}_{j}\right)^{2}}}$$

- $U_{ij}$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ü–µ–Ω–∏–ª–∏ —Ç–æ–≤–∞—Ä—ã $i$, $j$;
- $\overline{R}_i$ - —Å—Ä–µ–¥–Ω–µ–µ –æ—Ü–µ–Ω–æ–∫ —Ç–æ–≤–∞—Ä–∞ $i$.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –®–∞–≥–∏ Item-based filtering

- –ù–∞—Ö–æ–¥–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ , –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –¥–∞–Ω–Ω—ã–π:
$$I(i)=\{j\in I|w_{i j}>\alpha\}$$

- –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ö–æ–∂–∏–π —Ç–æ–≤–∞—Ä, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –ø–æ–∫—É–ø–∞–ª—Å—è:
$$p_{i}=\max\limits_j w_{i j}$$

–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –æ—Ü–µ–Ω–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
$$\hat{R}_{u i}=\frac{\sum_{j\in I(i)}w_{i j}R_{u j}}{\sum_{j\in I(i)}|w_{u v}|}$$

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é $u$ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º $k$ —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º–∏ $p_i$, –ª–∏–±–æ $\hat{R}_{u i}$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
<img src="./img/item_based_filtering.png" style="width:90%">
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Item-Based filtering
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
  - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–µ–ø–ª–æ—Ö–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —è–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫.
- –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
  - –î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã, –æ—Ü–µ–Ω–∫–∞ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –∏—Ö –±–ª–∏–∑–æ—Å—Ç–∏.
- –ü—Ä–æ–±–ª–µ–º–∞ —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞: –Ω–µ –∑–Ω–∞–µ–º, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –Ω–æ–≤—ã–º —Ç–æ–≤–∞—Ä–æ–º –∏–ª–∏
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

- –ú–µ—Ç–æ–¥—ã –Ω–µ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∏ –Ω–∞ –∫–∞–∫—É—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫—Ä–æ–º–µ –º–∞—Ç—Ä–∏—Ü—ã –æ—Ü–µ–Ω–æ–∫ $R_{ui}$, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ —ç—Ç–æ–≥–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —É–ª–∞–≤–ª–∏–≤–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –æ —Å—Ö–æ–∂–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–æ–≤–∞—Ä–æ–≤;
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã –¥–ª—è –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äì –¥–ª—è –Ω–∏—Ö –ø—Ä–æ—Å—Ç–æ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∏–ª–∏ –æ–Ω–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∞ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º–µ—Ç–æ–¥—ã –º–æ–≥–ª–∏ –¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ —Ç–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏;
- –¢–∞–∫ –∫–∞–∫ –º–µ—Ç–æ–¥—ã –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—à–ª—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –±—É–¥–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–≥–æ–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—É–∑—ã—Ä—å: —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–Ω–∏ —Å–ø–æ—Å–æ–±–Ω—ã —Ç–æ–ª—å–∫–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ –∏–º–µ—é—â–∏–µ—Å—è.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## Content-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –û—Å–Ω–æ–≤—ã–≤–∞—é—Ç—Å—è –Ω–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–∏ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–µ —Å—Ç–∞—Ç—å–∏ –ø—Ä–æ —Ç–æ, –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã  –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –ø–æ—Ö–æ–∂–∏–º–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è. 
- –í—Ö–æ–¥: —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞ (—Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏, –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –∫–∞—Ä—Ç–∏–Ω–∫–∏)\
- –í—ã—Ö–æ–¥: –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ (—ç–º–±–µ–¥–¥–∏–Ω–≥). 
- –ù–∏–∫–∞–∫–∞—è –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç–∞–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
–ú–æ–¥–µ–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—é—Ç –ø—Ä–æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–æ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
- –ü—É—Å—Ç—å –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ $e_i \in \mathbb{R}^n$ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç–µ–π). 
- –ü–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (–∏–ª–∏ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ) –¥–æ –æ—Ü–µ–Ω—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –æ—Ü–µ–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–∏, –∫–∞–∫:
$$\hat{r}_{ui} = \max\limits_{j\in I_u, r_{uj}> \alpha} \rho(e_i, e_j)r_{uj},$$
–≥–¥–µ
- $\rho$ -  —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏–ª–∏ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –≤–µ–∫—Ç–æ—Ä–∞–º–∏,
- $I_u$ ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ–±—ä–µ–∫—Ç–æ–≤,
- $\alpha$ ‚Äì –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
  - –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–æ–≤—ã—Ö –∏ —Å—Ç–∞—Ä—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö, —Ç–∞–∫ –∫–∞–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞.
- –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
  - –ø–æ—Ö–æ–∂–µ—Å—Ç—å –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂–µ—Ç –µ—â—ë –±–æ–ª—å—à–µ –∑–∞–≥–æ–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—É–∑—ã—Ä—å: –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –≤—Ä—è–¥ –ª–∏ —Å–º–æ–∂–µ—Ç –∫ –∫–æ—Ñ–µ–º–∞—à–∏–Ω–µ –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –∫–æ—Ñ–µ–π–Ω—ã–µ –∑–µ—Ä–Ω–∞, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø–æ–ª—É—á–∏—Ç —Å–∏–≥–Ω–∞–ª –æ —Ç–æ–º, —á—Ç–æ —Ç–æ–≤–∞—Ä—ã —è–≤–ª—è—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω—è—é—â–∏–º–∏ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –¥–µ–π—Å—Ç–≤–∏–π –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
 
C—É—â–µ—Å—Ç–≤—É—é—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–µ –º–æ–¥–µ–ª–∏, —Å–æ–≤–º–µ—â–∞—é—â–∏–µ –≤ —Å–µ–±–µ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–π —Å–∏–≥–Ω–∞–ª—ã. 
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –í–µ–∫—Ç–æ—Ä—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤

<img src="./img/matrix_pq.png" style="width:90%">

–ë—É–¥–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –º–∞—Ç—Ä–∏—Ü—É –æ—Ü–µ–Ω–æ–∫ —á–µ—Ä–µ–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–≤—É—Ö –º–∞—Ç—Ä–∏—Ü:
$$R=PQ^{T}$$

- $P$ - –º–∞—Ç—Ä–∏—Ü–∞ –∏–∑  –≤–µ–∫—Ç–æ—Ä—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
- $Q$ - –º–∞—Ç—Ä–∏—Ü–∞ –∏–∑ –≤–µ–∫—Ç–æ—Ä–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤;

–ù–∞–ø—Ä–∏–º–µ—Ä –ø—Ä–∏ —Ä–µ–∫–æ–º–Ω–µ–¥–∞—Ü–∏–∏ —Ñ–∏–ª—å–º–æ–≤ –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ñ–∏–ª—å–º –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤:
- –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äì –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è –∫–∞–∂–¥—ã–º –∂–∞–Ω—Ä–æ–º
- –¥–ª—è —Ñ–∏–ª—å–º–∞ ‚Äì –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –∂–∞–Ω—Ä—É
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
#### –ú–æ–¥–µ–ª—å —Å–æ —Å–∫—Ä—ã—Ç—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

–ó–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü $P$ –∏ $Q$  –Ω–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞:

$$\sum_{u,i}(R_{u i}-\bar{R}_{u}-\bar{R}_{i}-p_{u}^{T}q_{i})^{2}\rightarrow\operatorname*{min}_{P,Q}$$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
#### Latent Factor Model (LFM)

–ó–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü $P$ –∏ $Q$  –Ω–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞:
$$\sum_{u,i}(R_{u i}-\bar{R}_{u}-\bar{R}_{i}-p_{u}^{T}q_{i})^{2}+ 
\color{red}\lambda\sum_{u\in U}\vert\vert p_{u}\vert\vert^{2}+\mu\sum_{i\in I}\vert\vert q_{i}\vert\vert^{2}
\color{black}\rightarrow \min_{P,Q}$$

<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SGD

–ó–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü $P$ –∏ $Q$  –Ω–∞—Ö–æ–¥–∏–º —Å –ø–æ–º–æ—â—å—é —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞:

$$p_{u k}=p_{u k}+\eta q_{i k}(R_{u i}-\bar{R}_{u}-\bar{R}_{i}-p_{u}^{T}q_{i})$$

$$q_{i k}=q_{i k}+\eta p_{u k}(R_{u i}-\bar{R}_{u}-\bar{R}_{i}-p_{u}^{T}q_{i})$$

<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### Alternating Least Squares

- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
- –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É $Q$. –¢–æ–≥–¥–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è $P$:
$$p_{u}=\left(\sum_{i}q_{i}q_{i}^{T}\right)^{-1}\sum_{i}r_{u i}q_{i}$$
- –ó–∞—Ç–µ–º, —Ñ–∏–∫—Å–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É $P$. –¢–æ–≥–¥–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è $Q$:
$$q_{i}=\left(\sum_{u}p_{u}p_{u}^{T}\right)^{-1}\sum_{u}r_{u i}p_{u}$$
- –ü–æ–≤—Ç–æ—Ä—è–µ–º —à–∞–≥–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –°–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ (Singular Value Decomposition, SVD)

–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –ª—é–±–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–∞ $m \times n$ (—Ä–∞–Ω–≥–∞ $k$) –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–∞ –≤ –≤–∏–¥–µ $$X = =U\Sigma V^T,$$, 

–≥–¥–µ
- $\Sigma$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–∞ $m \times n$ —Å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏, —É –∫–æ—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç—ã, –ª–µ–∂–∞—â–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª–∏ ‚Äî —ç—Ç–æ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ —á–∏—Å–ª–∞, –∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –Ω–µ –ª–µ–∂–∞—â–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª–∏, –Ω—É–ª–µ–≤—ã–µ,
- –º–∞—Ç—Ä–∏—Ü—ã $U$ (—Ä–∞–∑–º–µ—Ä–∞ $m\times m$) –∏ $V$ (—Ä–∞–∑–º–µ—Ä–∞ $n\times n$ ‚Äî —ç—Ç–æ –¥–≤–µ —É–Ω–∏—Ç–∞—Ä–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã, —Å–æ—Å—Ç–æ—è—â–∏–µ –∏–∑ –ª–µ–≤—ã—Ö –∏ –ø—Ä–∞–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. 
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
#### SVD –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

–ú–∞—Ç—Ä–∏—Ü–∞ —Ç–æ–≤–∞—Ä–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π (–º–∞—Ç—Ä–∏—Ü–∞, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∞
—Å—Ç–æ–ª–±—Ü—ã —ç—Ç–æ –ø—Ä–æ–¥—É–∫—Ç—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∏)
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º —Ç—Ä–µ—Ö –º–∞—Ç—Ä–∏—Ü:

<img src="./img/matrix_svd.png" style="width:90%"> 

- $U$ ‚Äì –æ–ø–∏—Å–∞–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- $V$ ‚Äì –æ–ø–∏—Å–∞–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∞


- –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –∫–ª–µ—Ç–∫–∏, –≥–¥–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–∏ –Ω—É–ª–∏, –∞ –ø–æ—è–≤–∏–ª–∏—Å—å —á–∏—Å–ª–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–µ–ø–µ–Ω—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ
–∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ —Ç–æ–≤–∞—Ä—É. –£–ø–æ—Ä—è–¥–æ—á–∏–º —ç—Ç–∏ —Ü–∏—Ñ—Ä—ã, –∏ –ø–æ–ª—É—á–∏–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤,
—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ü—Ä–∏ —ç—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–ª—è—é—Ç—Å—è ¬´–ª–∞—Ç–µ–Ω—Ç–Ω—ã–µ¬ª
–ø—Ä–∏–∑–Ω–∞–∫–∏. –≠—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ ¬´—Å–∫—Ä—ã—Ç–æ–µ¬ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–∏ —Ç–æ–≤–∞—Ä–∞.
- –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–∞–∫–∏—Ö —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π
–≤–µ—Å—å–º–∞ —Ç—Ä—É–¥–æ–µ–º–∫–æ, –ø–æ—ç—Ç–æ–º—É –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ –ø—Ä–∏–±–µ–≥–∞—é—Ç –∫ –∏—Ö
–ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## Factorization Machines

- –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ —Ç–æ–≤–∞—Ä–∞—Ö?
- –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å?

<img src="./img/factorization_machines.png" style="width:90%">

<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ú–æ–¥–µ–ª—å

- –ü—Ä–æ–≥–Ω–æ–∑ –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è H() –¥–ª—è —Ç–æ–≤–∞—Ä–∞ :
$${\hat{y}}(x)=w_{0}+\sum_{i=1}^{n}w_{i}x_{i}+\sum_{i=1}^{n}\sum_{j=i+1}^{n}{\big(}v_{i}^{T}v_{j}{\big)}x_{i}x_{j}$$
  - $w_i$, $v_i$ -  –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏;
  - $n$-  —á–∏—Å–ª–æ –ø–∞—Ä –æ—Ü–µ–Ω–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö.
- –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞ –æ—Ü–µ–Ω–æ–∫.

<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –°–≤–æ–π—Å—Ç–≤–∞ (–º–µ—Ç—Ä–∏–∫–∏) —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ü–æ–ª–Ω–æ—Ç–∞ (Coverage)

–ü–æ–¥ –ø–æ–ª–Ω–æ—Ç–æ–π –≤ –¥–∞–Ω–Ω–æ–º –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –¥–æ–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ $I_{\text{recommended}}$ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ $I$.
$$\text{Coverage} = \cfrac{|I_{\text{recommended}}|}{|I|}$$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –ù–æ–≤–∏–∑–Ω–∞ (Novelty)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ $i$ —Å—á–∏—Ç–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —Å –∫–æ—Ç–æ—Ä–æ–π –µ–≥–æ –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç —Å–ª—É—á–∞–π–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: $P_{i} = \frac{m_{i}}{N}$, –≥–¥–µ $ m_{i} $ ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –±—ã–ª –ø–æ–∫–∞–∑–∞–Ω $i$-–π –æ–±—ä–µ–∫—Ç, –∞ $N$ ‚Äì –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. 
–î–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Å—Ä–µ–¥–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–ø–∏—Å–∫—É –µ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π $R$ –∏ –ø–æ–ª—É—á–∞–µ–º –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
$$\text{Novelty}_u = \cfrac{1}{|R|}\sum\limits_{i\in R} {-\log (p(i))}$$
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ (Diversity)

–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é –æ–±—ä–µ–∫—Ç—ã. –¢–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —É—Å–ø–µ—Ö–∞ —Å–µ—Ä–≤–∏—Å–æ–≤, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ –æ–±—ä–µ–∫—Ç—ã, —Ç–æ —Ä–∞–Ω–æ –∏–ª–∏ –ø–æ–∑–¥–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞—Å–∫—É—á–∞—Ç —Ç–∞–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

–û–¥–Ω–∞ –∏–∑ –º–µ—Ç—Ä–∏–∫ –Ω–æ–≤–∏–∑–Ω—ã **Intra List Similarity (ILS)**. –î–ª—è –µ–µ —Ä–∞—Å—á—ë—Ç–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω—É–∂–Ω–æ —É—Å—Ä–µ–¥–Ω–∏—Ç—å –ø–æ–ø–∞—Ä–Ω—É—é —Å—Ö–æ–∂–µ—Å—Ç—å $\text{sim}$ –º–µ–∂–¥—É —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏:
$$ILS_u= \cfrac{1}{|R|}
\sum\limits_{i\in R} \sum\limits_{j\in R} \text{sim}(i,j),$$

–≥–¥–µ $R$ ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–±—ä–µ–∫—Ç–æ–≤.
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
### Serendipity ($\approx$ ¬´–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–∑–æ—Ä–ª–∏–≤–æ—Å—Ç—å¬ª)

Serendipity ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ –µ—â—ë –∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ç–æ–≥–æ, —Å –∫–∞–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª –≤ –ø—Ä–æ—à–ª–æ–º.

Serendipity ‚Äì –¥–æ–≤–æ–ª—å–Ω–æ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –∏ –µ–≥–æ —Å–ª–æ–∂–Ω–æ —Ñ–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å.
–û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

$$\text{Serendipity}_u = \sum\limits_{i\in R}\max (Pr_u(i) - Prim_u(i), 0) \cdot rel_u(i)
$$

- $R_u$ ‚Äì —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
- $Pr_u(i)$) ‚Äì –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞,
- $Prim_u(i)$ ‚Äì –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏ (–≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–π –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–≤—Ä–∏—Å—Ç–∏–∫ –±–µ–∑ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Å—Ç—É—é –Ω–µ–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å),
- $rel$ ‚Äì –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. 


<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->


<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
<img src="./img/pipeline.png" style="width:90%">
<!-- #endregion -->

<!-- #region id="zvxMDFiSa-aU" editable=true slideshow={"slide_type": "slide"} -->
## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

- –ü—Ä–∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è $\hat{r}_{ui}$ –Ω–∞–º —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ —Å–∏–≥–Ω–∞–ª–æ–≤/—Ñ–∏—á–µ–π (–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–∫ –∏ –æ–±—ä–µ–∫—Ç–∞);
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ;
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ—Å–ª–æ–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–Ω—è—Ç–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å ¬´–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É¬ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø—Ä–∏ –ø—Ä–æ—á–∏—Ö —Ä–∞–≤–Ω—ã—Ö –º—ã –±–æ–ª—å—à–µ —Ö–æ—Ç–∏–º –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–≤–µ–∂–∏–µ —Å—Ç–∞—Ç—å–∏).

<!-- #endregion -->
