---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.16.4
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

<!-- #region editable=true jupyterlab-deck={"layer": "deck"} slideshow={"slide_type": "slide"} -->
# –õ–µ–∫—Ü–∏—è 9: –õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

–ú–ì–¢–£ –∏–º. –ù.–≠. –ë–∞—É–º–∞–Ω–∞

–ö—Ä–∞—Å–Ω–∏–∫–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á

2024
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ó–∞–¥–∞—á–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

<table>
  <tr>
    <td>
      <ul>
    <li>–î–∞–Ω –Ω–∞–±–æ—Ä –∏–∑ $ùëõ$ —Ç–æ—á–µ–∫: $\{x_i, y_i\}_{i=1}^n$, –≥–¥–µ
        <ul>
  <li>$x_i = (x_{i1}, x_{i2}, \ldots, x_{id})^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –∏–∑ $d$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞;</li>
  <li>$y_i$ &mdash; —Å–∫–∞–ª—è—Ä–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –¥–ª—è –æ–±—ä–µ–∫—Ç–∞.</li>
        </ul></li>
    <li>–ù—É–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é
–≤–µ–ª–∏—á–∏–Ω—É $y$</li>
    <li>–§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å $y$ –æ—Ç $ùëã$ &mdash; <strong>–º–æ–¥–µ–ª—å
—Ä–µ–≥—Ä–µ—Å—Å–∏–∏</strong></li>
  </ul>
    </td>
    <td><img src="./img/simple_linreg.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è. –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
<img src="./img/linreg.png">

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–µ–∫—Ç–æ—Ä–Ω–∞—è —Ñ–æ—Ä–º–∞

- –ú–æ–¥–µ–ª—å **–ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏**: $$\hat{y}_i = w_0 + \sum_{j=1}^d w_j x_{ij},$$ –≥–¥–µ
  - $w_j$ &mdash; –≤–µ—Å $j$-—Ç–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –º–æ–¥–µ–ª–µ;
  - $\hat{y}_i$ &mdash; –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è $i$-—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.
- –ö–≤–∞–¥—Ä–∞—Ç –æ—à–∏–±–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è $i$-—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞: $(\hat{y}_i - y_i)^2$.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–æ—Ä–º–∞

- –ú–æ–¥–µ–ª—å **–ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏**: $$\hat{y} = X w,$$ –≥–¥–µ
  - $X =
  \begin{bmatrix}
    1 & x_{11} & \cdots & x_{1d}\\
    \vdots & \vdots  & \ddots  & \vdots \\
    1 & x_{n1} & \cdots & x_{nd}
  \end{bmatrix}$ &mdash; –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤–∞;
  - $w = (w_0, w_1, w_2, \ldots, w_d)^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä $d+1$ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏; 
  - $\hat{y} = (\hat{y}_1, \hat{y}_2, \ldots, \hat{y}_n)^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–ª—è $n$ –æ–±—ä–µ–∫—Ç–æ–≤.
- –ö–≤–∞–¥—Ä–∞—Ç –æ—à–∏–±–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è $i$-—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞: $(\hat{y} - y)^2$.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å

- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å** (**Loss function**) –¥–ª—è –∑–∞–¥–∞—á–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
$$
L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left(\hat{y}_i - y_i\right)^2
= \cfrac{1}{n} (\hat{y} - y)^\top (\hat{y} - y),
$$ 
- –°–º—ã—Å–ª $L(X, w)$ &mdash; —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ (Mean Squared Error (MSE))
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å $L(X, w)$:$$L(X, w) \rightarrow \min\limits_w$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –û–±—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

<img src="./img/linclass_learn.png">
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": ""} -->
$$L(X,w) = (\hat{y} - y)^\top (\hat{y} - y) = (Xw - y)^\top (Xw - y)$$

–î–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ $L(X,w)$:
$$\cfrac{\partial L}{\partial w} = 0$$

–¢–æ–≥–¥–∞ 
$$\cfrac{\partial L}{\partial w} = 2X^\top(Xw-y) = 2X^\top Xw - 2X^\top y,$$
$$ 2X^\top Xw = 2X^\top y,$$
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ $w$ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:

$$w = \left(X^\top X\right)^{-1}X^\top y$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
### –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è. –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫.

<table>
  <tr>
    <td>
      <ul>
    <li>–ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è $ùêø(X, w)$</li>
    <li>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –µ–µ –º–∏–Ω–∏–º—É–º: $$L(X, w) \rightarrow \min\limits_w$$</li>
    <li>–ò–∑–≤–µ—Å—Ç–µ–Ω —Å–ø–æ—Å–æ–± –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $\cfrac{\partial L}{\partial w}$</li>
    <li>–ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ (–∏–ª–∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ) —Ä–µ—à–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ$\cfrac{\partial L}{\partial w} = 0$</li>
  </ul>
    </td>
    <td><img src="./img/linreg_grad.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏

- –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ $\nabla L$ &mdash; –≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–≤—ã—Ö —á–∞—Å—Ç–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏:
$$ \cfrac{\partial L}{\partial w} 
=\nabla L(X, w_0, w_1, \ldots, w_d)  
= 
\left(
  \cfrac{\partial L}{\partial w_0}, 
  \cfrac{\partial L}{\partial w_1},
  \ldots,
  \cfrac{\partial L}{\partial w_d}
\right) , 
$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
### –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫

- –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è $ùêø(X, w)$
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –µ–µ –º–∏–Ω–∏–º—É–º: $$L(X, w) \rightarrow \min\limits_w$$
-  –ü—É—Å—Ç—å $w^{(0)}$ &mdash; –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä,  $w^{(0)} = 0$
- –¢–æ–≥–¥–∞ **–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫** —Å–æ—Å—Ç–æ–∏—Ç –≤ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ —à–∞–≥–æ–≤:
$$w^{(k+1)} = w^{(k)} - \eta \nabla L(X, w^{(k)})$$
- $\eta$ &mdash; –¥–ª–∏–Ω–∞ —à–∞–≥–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ (**learning rate**) (–∑–∞–¥–∞–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–º)
- $k$ &mdash; –Ω–æ–º–µ—Ä –∏—Ç–µ—Ä–∞—Ü–∏–∏
- $\nabla L(X, w^{(k)})$ &mdash; –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏–∏ $k$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏

- –ú–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
$$\hat{y} = Xw$$
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å MSE:
$$L(X, w) = 
 \cfrac{1}{n} (\hat{y} - y)^\top (\hat{y} - y)=
  \cfrac{1}{n} (Xw - y)^\top (Xw - y)$$
- –ì—Ä–∞–¥–∏–µ–Ω—Ç:
$$\nabla L(X, w^{(k)}) = \cfrac{2}{n}X^\top (Xw-y)$$
- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫:
$$w^{(k+1)} = w^{(k)} - \eta \nabla L(X, w^{(k)}) = 
w^{(k)} - \eta \cfrac{2}{n}X^\top (Xw-y) $$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –°–≤–æ–π—Å—Ç–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

<table>
  <tr>
    <td>
<p>–ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Ç–æ—á–∫–µ
–æ—Ä—Ç–æ–≥–æ–Ω–∞–ª–µ–Ω –ª–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è,
–ø—Ä–æ—Ö–æ–¥—è—â–µ–π —á–µ—Ä–µ–∑ —ç—Ç—É —Ç–æ—á–∫—É</p>
  </ul>
    </td>
    <td><img src="./img/prop_grad_1.png"></td>
  </tr>
  <tr>
    <td>
<p>–ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç
–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∏—Å–∫–æ—Ä–µ–π—à–µ–≥–æ
–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –¥–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ</p>
<p>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω—Ç–∏–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç
–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∏—Å–∫–æ—Ä–µ–π—à–µ–≥–æ —É–±—ã–≤–∞–Ω–∏—è
—Ñ—É–Ω–∫—Ü–∏–∏ –≤ –¥–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ</p>
  </ul>
    </td>
    <td><img src="./img/prop_grad_2.png"></td>
  </tr>
</table>

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–æ–±–ª–µ–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞

- –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –¥–ª–∏–Ω—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞?
- –°–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–µ–ª–∞—Ç—å?
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ü—Ä–æ–±–ª–µ–º–∞ –≤—ã–±–æ—Ä–∞ —à–∞–≥–∞

<img src="./img/grad_learn_rate.png">
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ —à–∞–≥–∞

- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞: $\eta = const$
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π $k$: $\eta_k = \cfrac{1}{k}$
- –î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:$\eta_k = \lambda \left(\cfrac{s_0}{s_0+k}\right)^p$, –≥–¥–µ
$\lambda$, $s_0$, $p$ - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ $s_0=1$, $p=0.5$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

- –ë–ª–∏–∑–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∫ –Ω—É–ª—é: $\nabla ùêø \approx 0$
- –ú–∞–ª–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –≤–µ—Å–æ–≤ –Ω–∞ $k$-—Ç–æ–º —à–∞–≥–µ: $\|w^{(k+1)}-w^{(k)}\|\approx 0$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫


<table>
  <tr>
    <td>
<p>–ü–æ–ª–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫
$$L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left(\hat{y}_i - y_i\right)^2,$$
$$w^{(k+1)} = w^{(k)} - \eta \nabla L(X, w^{(k)})$$</p>
  </ul>
    </td>
    <td><img src="./img/gradient_descent.png"></td>
  </tr>
  <tr>
    <td>
<p>–°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫
$$L_i(X, w) = 
\left(\hat{y}_i - y_i\right)^2,$$
$$w^{(k+1)} = w^{(k)} - \eta \nabla L_i(X, w^{(k)})$$</p>
  </ul>
    </td>
    <td><img src="./img/stochastic_gradient_descent.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞

<img src="./img/gradient_descent_2.png">

- –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –ì–° —Ç—Ä–µ–±—É–µ—Ç –º–µ–Ω—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–π
- –í –ø–æ–ª–Ω–æ–º –ì–° –æ–±—É—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ
- –ü–æ–ª–Ω—ã–π –ì–° —Ç—Ä–µ–±—É–µ—Ç –º–µ–Ω—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π, –Ω–æ –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

- –ú–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
$$\hat{y}_i = w_0 + w_1x_{i1} + w_2 x_{i2}$$
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å MSE:
$$L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left(\hat{y}_i - y_i\right)^2
\rightarrow \min\limits_w$$
- –ü—É—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∞–∑–Ω—ã–µ –ø–æ –º–∞—Å—à—Ç–∞–±—É:
–Ω–∞–ø—Ä–∏–º–µ—Ä $|x_1| \approx 1$, $|x_2|\approx 1000$
- –¢–æ–≥–¥–∞
  - –º–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è $dw_1$ ( –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –º–∞–ª—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º $L(X,w)$
  - –º–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è $dw_2$ ( –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –±–æ–ª—å—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º $L(X,w)$)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

<img src="./img/data_normal.png">

- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫
- –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–µ–µ
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ù–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏


<table>
  <tr>
    <td>
<ul>
    <li>–ü—É—Å—Ç—å –¥–∞–Ω –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ $x_i$</li>
    <li>–í—ã–±–µ—Ä–µ–º –ª—é–±—ã–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç $x$: 
        $\phi_0(x)$, $\phi_1(x)$, $\ldots$, $\phi_M(x)$.
        –ù–∞–ø—Ä–∏–º–µ—Ä, $x^2$, $sin(x)$, $e^{-x}$
    </li>
    <li>–¢–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
    $$\hat{y}_i = \sum\limits_{j=0}^k w_j\phi_j(x_i)$$
    </li>
  </ul>
    </td>
    <td><img src="./img/nonlinear.png"></td>
  </tr>
</table>

<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ü—Ä–æ–±–ª–µ–º–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

- –ú–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
$$\hat{y}_i = w_0 + \sum\limits_{j=0}^d w_j x_{ij}$$
- –û—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞:
$|\hat{y}_i - y_i|$
- –ü—É—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Å–æ–≤ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –ø–æ –º–æ–¥—É–ª—é,
–Ω–∞–ø—Ä–∏–º–µ—Ä $|w_j| > 10^3$
- –¢–æ–≥–¥–∞ –º–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è $dx_{ij}$ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º
–∏–∑–º–µ–Ω–µ–Ω–∏—è–º $d\hat{y}_i = |w_j dx_{ij}|$
- –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ–π
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏
- –î–æ–±–∞–≤–∏–º –∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å $L(X,w)$ —à—Ç—Ä–∞—Ñ $R(w)$ –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—É
–≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏:
$$L_\alpha(X,w) = L(X,w) + \alpha R(w),$$
–≥–¥–µ $\alpha$ &mdash; –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ (–ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–º)
- –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Å–∞–º –º–æ–¥–µ–ª–∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–ª–∏—à–∫–æ–º
–±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–∏–¥—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

- $L_1$ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Lasso):
$$R_1(w) = \sum\limits_{j=1}^d |w_j|$$
- $L_2$ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Ridge):
$$R_2(w) = \sum\limits_{j=1}^d w_j^2$$
- $L_1 + L_2$ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Elastic Net):
$$R_\alpha(w) = \alpha_1 R_1(w) + \alpha_2 R_2(w) $$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –°–≤–æ–π—Å—Ç–≤–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

- $L_1$ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –æ–±–Ω—É–ª—è—è –≤–µ—Å–∞ –¥–ª—è –Ω–∞–∏–º–µ–Ω–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- $L_2$ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–µ–º–∏—Ç—Å—è —É–º–µ–Ω—å—à–∏—Ç—å –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π:
$$L_\alpha(X,w) = L(X,w) + \alpha R(w)$$
- $w$ &mdash; –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è (**–ø–∞—Ä–∞–º–µ—Ç—Ä—ã**).
- $\alpha$ &mdash;  –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞–≤–∞–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (**–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä**).
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature importance)

<table>
  <tr>
    <td>
      <ul>
    <li>–ù–µ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏</li>
    <li>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã, —á–µ–º –¥—Ä—É–≥–∏–µ</li>
    <li>–ù–∞–ø—Ä–∏–º–µ—Ä, $X_1$ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∞ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
    <li>–¶–µ–ª—å ‚Äì –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞</li>
  </ul>
    </td>
    <td><img src="./img/importance_cls.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏
<table>
  <tr>
    <td>
      <ul>
    <li>–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ª–∏–Ω–µ–π–Ω—É—é –º–æ–¥–µ–ª—å —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π ($L_1$ –∏–ª–∏ $L_2$): $$\hat{y} = w_0 + w_1 x_1 + w_2 x_2 + \ldots + w_d x_d$$</li>
    <li>–ï—Å–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã (–∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞), —Ç–æ
–≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∞ $x_j$ —Ä–∞–≤–Ω–∞:$$\text{Imp}(x_j) = |w_j|$$</li>
  </ul>
    </td>
    <td><img src="./img/importance_reg.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –õ–∏–Ω–µ–π–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

<table>
  <tr>
    <td>
      <ul>
    <li>–î–∞–Ω –Ω–∞–±–æ—Ä –∏–∑ $ùëõ$ —Ç–æ—á–µ–∫: $\{x_i, y_i\}_{i=1}^n$, –≥–¥–µ
        <ul>
  <li>$x_i = (x_{i1}, x_{i2}, \ldots, x_{id})^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –∏–∑ $d$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞;</li>
  <li>$y_i = \{-1, +1\}$, &mdash; –º–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞.</li>
        </ul></li>
    <li>–ù—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –ø–æ
–∫–ª–∞—Å—Å–∞–º –Ω–µ–∫–æ—Ç–æ—Ä–æ–π
<strong>–≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å—é</strong></li>
    <li>–≠—Ç—É –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –±—É–¥–µ–º
–Ω–∞–∑—ã–≤–∞—Ç—å <strong>–ª–∏–Ω–µ–π–Ω—ã–º
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º</strong></li>
  </ul>
    </td>
    <td><img src="./img/hyperstrip.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–µ–∫—Ç–æ—Ä–Ω–∞—è —Ñ–æ—Ä–º–∞

- –ú–æ–¥–µ–ª—å **–ª–∏–Ω–µ–π–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: $$\hat{y}_i = \text{sign} \left(w_0 + \sum_{j=1}^d w_j x_{ij}\right),$$ –≥–¥–µ
  - $w_j$ &mdash; –≤–µ—Å $j$-—Ç–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –º–æ–¥–µ–ª–µ;
  - $\hat{y}_i$ &mdash; –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è $i$-—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.
- –û—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è  $i$-—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞: $\hat{y}_i \ne y_i$.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–æ—Ä–º–∞

- –ú–æ–¥–µ–ª—å **–ª–∏–Ω–µ–π–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: $$\hat{y} = \text{sign} \left(X w\right),$$ –≥–¥–µ
  - $X =
  \begin{bmatrix}
    1 & x_{11} & \cdots & x_{1d}\\
    \vdots & \vdots  & \ddots  & \vdots \\
    1 & x_{n1} & \cdots & x_{nd}
  \end{bmatrix}$ &mdash; –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤–∞;
  - $w = (w_0, w_1, w_2, \ldots, w_d)^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä $d+1$ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏; 
  - $\hat{y} = (\hat{y}_1, \hat{y}_2, \ldots, \hat{y}_n)^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–ª—è $n$ –æ–±—ä–µ–∫—Ç–æ–≤.
- –í–µ–∫—Ç–æ—Ä –æ—à–∏–±–æ–∫ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –º–æ–¥–µ–ª–∏: $\hat{y}_i \ne y_i$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å

- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å** (**Loss function**) –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
$$
L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left[\hat{y}_i \ne y_i\right]
= \cfrac{1}{n} \sum\limits_{i=1}^n\left[Xw \ne y\right],
$$ –≥–¥–µ
$\left[\hat{y}_i \ne y_i\right] = 
\begin{cases} 
0, & \text{–µ—Å–ª–∏} \; \hat{y}_i = y_i, \\ 
1, & \text{–µ—Å–ª–∏} \; \hat{y}_i \ne y_i.
\end{cases}
$ 
- –°–º—ã—Å–ª $L(X, w)$ &mdash; –¥–æ–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å $L(X, w)$: $$L(X, w) \rightarrow \min\limits_w$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –û–±—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

<img src="./img/linclass_learn.png">
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–æ–±–ª–µ–º—ã –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å

- –î–∏—Å–∫—Ä–µ—Ç–Ω–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
- –ù–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π (0, –ª–∏–±–æ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞)
- –ù–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫
- –ú–Ω–æ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–æ–≤ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–ª–∞—Å—Å—ã)
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ì–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å

<img src="./img/hyperstrip.png">
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –û—Ç—Å—Ç—É–ø

<table>
  <tr>
    <td>
      <ul>
    <li>
        <strong>–û—Ç—Å—Ç—É–ø (margin)</strong> ùëÄ: $$z = Xw,$$ $$M=yz = yXw$$
  <li>–ó–Ω–∞–∫ –æ—Ç—Å—Ç—É–ø–∞ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞
  <ul>
      <li>$M_i > 0$ &mdash; –≤–µ—Ä–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑,</li>
      <li>$M_i < 0$ &mdash; –Ω–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑,</li>
      <li>$M_i = 0$ &mdash; –æ—Ç–∫–∞–∑ –æ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ—á–∫–∞ –ª–µ–∂–∏—Ç –Ω–∞ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏)</li>
  </ul>
  </li>
  <li>–ê–±—Å–æ–ª—é—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –æ—Ç—Å—Ç—É–ø–∞ &mdash; —Å—Ç–µ–ø–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞</li>
    <li>–ß–µ–º –±–ª–∏–∂–µ $ùëÄ$ –∫ 0, —Ç–µ–º –±–ª–∏–∂–µ –æ–±—ä–µ–∫—Ç –∫ –≥—Ä–∞–Ω–∏—Ü–µ –∫–ª–∞—Å—Å–æ–≤</li>
  </ul>
    </td>
    <td><img src="./img/hyperstrip.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
<img src="./img/margin.png">
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å

- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å** (**Loss function**) –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
$$
L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left[M_i < 0\right]
= \cfrac{1}{n} \left[yXw < 0\right];$$
- –°–º—ã—Å–ª $L(X, w)$ &mdash; –¥–æ–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤;
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å $L(X, w)$:$$L(X, w) \rightarrow \min\limits_w$$.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å

- –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
$$
L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left[M_i < 0\right];$$
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫;
- –•–æ—Ä–æ—à–æ –±—ã –∑–∞–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –Ω–∞ –≥–ª–∞–¥–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é.
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –í–µ—Ä—Ö–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å

- –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
$$L(M_i) = \left[M_i < 0\right]$$
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é $\tilde{L}(M_i)$, —á—Ç–æ
$$L(M_i) \leqslant \tilde{L}(M_i)$$
- –¢–æ–≥–¥–∞ –≤–µ—Ä—Ö–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
$$
L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n\left[M_i < 0\right]
\leqslant 
\cfrac{1}{n} \sum\limits_{i=1}^n  \tilde{L}(M_i)
$$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∏–º–µ—Ä—ã –≤–µ—Ä—Ö–Ω–∏—Ö –æ—Ü–µ–Ω–æ–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å

<table>
  <tr>
    <td>
      <ul>
    <li>$\tilde{L}(M) = \log \left( 1 + e^{-M}\right)$ &mdash; –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;</li>
    <li>$\tilde{L}(M) = \max(0; 1-M)$ &mdash; –∫—É—Å–æ—á–Ω–æ-–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;</li>
    <li>$\tilde{L}(M) = \max(0; -M)$ &mdash; –∫—É—Å–æ—á–Ω–æ-–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;</li>
    <li>$\tilde{L}(M) = e^{-M}$ &mdash; —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;</li>
    <li>$\tilde{L}(M) = 2 \left(1+e^M\right)^{-1}$ &mdash;  —Å–∏–≥–º–æ–∏–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;</li>
  </ul>
    </td>
    <td><img src="./img/lossapprox.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "slide"} -->
## –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

<table>
  <tr>
    <td>
      <ul>
    <li>–î–∞–Ω –Ω–∞–±–æ—Ä –∏–∑ $ùëõ$ —Ç–æ—á–µ–∫: $\{x_i, y_i\}_{i=1}^n$, –≥–¥–µ
        <ul>
  <li>$x_i = (x_{i1}, x_{i2}, \ldots, x_{id})^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –∏–∑ $d$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞;</li>
  <li>$y_i = \{0, 1\}$, &mdash; –º–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞.</li>
        </ul></li>
    <li> –ú–æ–¥–µ–ª—å **–ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏**:
$$\hat{y}_i = \sigma\left(Xw\right),$$ –≥–¥–µ $\sigma\left(z\right) = \cfrac{1}{1+e^{-z}}$</li>
    <li>$\hat{y}_i = \sigma \left(x_i^\top w\right) = p\left(y=1 | x_i\right)$ &mdash; <strong>–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ 1</strong> –¥–ª—è $i$-—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞.</li>
    <li>1 - $\hat{y}_i = 1 - \sigma \left(x_i^\top w\right) = p\left(y=0 | x_i\right)$ &mdash; <strong>–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ 0</strong> –¥–ª—è $i$-—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞.</li>
  </ul>
    </td>
    <td><img src="./img/sigmoid.png"></td>
  </tr>
</table>
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (**log-loss**)

- –ï—Å–ª–∏ $y_i = \{0, 1\}$: (–¥–∞–ª–µ–µ –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç)
$$L(X, w) = 
-\cfrac{1}{n} \sum\limits_{i=1}^n
\left(
  y_i \log(\hat{y}_i) + (1-y_i)\log(1-\hat{y}_i)
\right)
;$$
- –ï—Å–ª–∏ $y_i = \{-1, +1\}$:
$$L(X, w) = 
\cfrac{1}{n} \sum\limits_{i=1}^n
  \log\left(1+e^{-M}\right)
;$$
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å $L(X, w)$:$$L(X, w) \rightarrow \min\limits_w$$
- –î–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫:
$$w^{(k+1)} = w^{(k)} - \eta \nabla L(X, w^{(k)}) $$
<!-- #endregion -->

<!-- #region editable=true slideshow={"slide_type": "subslide"} -->
### –ü—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ

<table>
  <tr>
    <td>
      <ul>
    <li>–î–∞–Ω –Ω–∞–±–æ—Ä –∏–∑ $ùëõ$ —Ç–æ—á–µ–∫: $\{x_i, y_i\}_{i=1}^n$, –≥–¥–µ
        <ul>
  <li>$x_i = (x_{i1}, x_{i2}, \ldots, x_{id})^\top$ &mdash; –≤–µ–∫—Ç–æ—Ä –∏–∑ $d$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞;</li>
  <li>$y_i = \{0, 1\}$, &mdash; –º–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞.</li>
        </ul></li>
    <li> –ü—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ:
$$\text{Likelihood} = \prod_{i=1}^n 
        p\left(y=1 | x_i\right)^{[y_i=1]}
        p\left(y=0 | x_i\right)^{[y_i=0]}
        \rightarrow \max\limits_w
$$</li>
    <li> –õ–æ–≥–∞—Ä–∏—Ñ–º –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è:
$$
    \text{Log Likelihood} = \sum_{i=1}^n 
        y_i \log(p(y=1 | x_i)) + 
        (1- y_i) \log(p(y=1 | x_0)) = 
$$
$$ 
= 
    \sum_{i=1}^n 
        y_i \log(\hat{y}_i) + 
        (1- y_i) \log(1- \hat{y}_i) 
        = - n L(X, w)
        $$
    </li>
  </ul>
    </td>
    <td><img src="./img/likelihood .png"></td>
  </tr>
</table>
<!-- #endregion -->
